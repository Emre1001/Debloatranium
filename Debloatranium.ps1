$Lang = @{
    "en" = @{
        "Welcome"           = "Welcome to Debloatranium 2025!"
        "ChooseLang"        = "Choose language (en/de/tr):"
        "ChooseLevel"       = "Select debloat level:"
        "Options"           = @(
            "1) Minimum - Light tweaks, High Performance power plan, Dark Mode, remove Edge, clean taskbar, disable telemetry",
            "2) Light - Remove ultra unnecessary apps (Xbox, OneDrive, Solitaire, YourPhone, Weather, Zune) + all from Minimum",
            "3) Medium - Remove more apps (Outlook, Mail, Calendar, Maps, People, Camera, Calculator, Print3D) + many system & performance tweaks + all from Light",
            "4) High - Remove ALL apps except Paint & Photos + very many tweaks + all from Medium",
            "5) Extreme - Remove EVERYTHING possible (including Store, security features) for maximum performance + all from High",
            "6) Custom - Choose what to remove/optimize individually"
        )
        "InvalidChoice"     = "Invalid choice. Exiting."
        "Confirm"           = "Are you sure you want to continue? (Y/N):"
        "Aborted"           = "Operation aborted by user."
        "Running"           = "Running debloat level:"
        "DownloadingBrowsers"= "Downloading and installing browsers..."
        "Done"              = "Debloatranium finished successfully."
        "Error"             = "An error occurred:"
        "NeedAdmin"         = "Please run this script as Administrator!"
        "YesNoPrompt"       = "Do you want to apply this? (Y/N):"
        "IsFreshWindows"    = "Is this a fresh Windows installation? (Y/N):"
        "EdgeWarning"       = "WARNING: Microsoft Edge will be removed. Ensure you have another browser or install one now."
        "AlreadyHaveBrowser"= "Do you already have another browser installed and prefer to use it? (Y/N):"
        "RecommendedInstallBrowser" = "It is highly recommended to install a browser now to ensure you have internet access after debloating."
        "InstallAnyBrowsers"= "Do you want to install any browsers?"
        "NoBrowsersInstalled" = "No browsers will be installed."
        "RestartPrompt"     = "Press any key to restart your PC..."
        "ExtremeWarning"    = "WARNING: Extreme debloat will remove critical components like Microsoft Store and disable security features (Windows Defender, SmartScreen). This is NOT recommended for most users and can make your system vulnerable and unstable. Continue?"
        "PowerPlan"         = "Set Power Plan to High Performance"
        "DarkMode"          = "Enable Dark Mode"
        "TaskbarJunk"       = "Clean Taskbar (remove ads, search highlights, etc.)"
        "Telemetry"         = "Disable Telemetry & Data Collection"
        "RemoveEdge"        = "Remove Microsoft Edge"
        "SystemTweaks"      = "Apply System Tweaks (Delivery Optimization, Driver Updates, Tips/Tricks, Lock Screen Ads, Error Reporting, Game Bar)"
        "PerformanceTweaks" = "Apply Performance Tweaks (visual effects, Superfetch/SysMain)"
        "XboxApps"          = "Remove Xbox Apps (Xbox App, Gaming Overlay, SpeechToTextOverlay)"
        "OneDrive"          = "Remove OneDrive"
        "MixedReality"      = "Remove Mixed Reality Portal"
        "CommonApps"        = "Remove Common Bloatware Apps (Solitaire, Skype, YourPhone, Weather, GetHelp, Getstarted, Groove Music, Movies & TV)"
        "AggressiveApps"    = "Remove Aggressive Bloatware Apps (Outlook, Mail, Calendar, Maps, People, Camera, Calculator, Print3D)"
        "AllAppsExceptBasics" = "Remove ALL apps except Paint & Photos"
        "WindowsDefender"   = "Disable Windows Defender and security features (CRITICAL SECURITY RISK)"
        "SmartScreen"       = "Disable SmartScreen"
        "MicrosoftStore"    = "Remove Microsoft Store"
        "SystemRestore"     = "Disable System Restore"
        "Hibernation"       = "Disable Hibernation"
        "TempFiles"         = "Clear Temporary Files"
        "RemovePaint"       = "Remove Microsoft Paint"
        "RemovePhotos"      = "Remove Microsoft Photos"
    }
    "de" = @{
        "Welcome"           = "Willkommen bei Debloatranium 2025!"
        "ChooseLang"        = "Sprache wählen (en/de/tr):"
        "ChooseLevel"       = "Wähle Debloat-Stufe:"
        "Options"           = @(
            "1) Minimum - Leichte Optimierungen, Höchstleistung-Energieplan, Dark Mode, Edge entfernen, Taskleiste säubern, Telemetrie deaktivieren",
            "2) Leicht - Ultra unnötige Apps entfernen (Xbox, OneDrive, Solitaire, YourPhone, Wetter, Zune) + alles von Minimum",
            "3) Mittel - Weitere Apps entfernen (Outlook, Mail, Kalender, Karten, Kontakte, Kamera, Rechner, 3D-Druck) + viele System- & Performance-Tweaks + alles von Leicht",
            "4) Hoch - ALLE Apps außer Paint & Fotos entfernen + sehr viele Tweaks + alles von Mittel",
            "5) Extreme - ALLES entfernen, was möglich ist (inkl. Store, Sicherheitsfunktionen) für maximale Performance + alles von Hoch",
            "6) Custom - Wähle einzeln, was entfernt/optimiert wird"
        )
        "InvalidChoice"     = "Ungültige Eingabe. Programm wird beendet."
        "Confirm"           = "Bist du sicher, dass du fortfahren willst? (J/N):"
        "Aborted"           = "Vom Benutzer abgebrochen."
        "Running"           = "Starte Debloat-Stufe:"
        "DownloadingBrowsers"= "Browser werden heruntergeladen und installiert..."
        "Done"              = "Debloatranium wurde erfolgreich abgeschlossen."
        "Error"             = "Ein Fehler ist aufgetreten:"
        "NeedAdmin"         = "Bitte führe das Skript als Administrator aus!"
        "YesNoPrompt"       = "Willst du das anwenden? (J/N):"
        "IsFreshWindows"    = "Ist dies eine frische Windows-Installation? (J/N):"
        "EdgeWarning"       = "WARNUNG: Microsoft Edge wird entfernt. Stelle sicher, dass du einen anderen Browser hast oder installiere jetzt einen."
        "AlreadyHaveBrowser"= "Hast du bereits einen anderen Browser installiert und möchtest diesen verwenden? (J/N):"
        "RecommendedInstallBrowser" = "Es wird dringend empfohlen, jetzt einen Browser zu installieren, um nach dem Debloating Internetzugang zu gewährleisten."
        "InstallAnyBrowsers"= "Möchtest du Browser installieren?"
        "NoBrowsersInstalled" = "Es werden keine Browser installiert."
        "RestartPrompt"     = "Drücke eine Taste, um deinen PC neu zu starten..."
        "ExtremeWarning"    = "WARNUNG: Extreme Debloat entfernt kritische Komponenten wie den Microsoft Store und deaktiviert Sicherheitsfunktionen (Windows Defender, SmartScreen). Dies wird für die meisten Benutzer NICHT empfohlen und kann dein System anfällig und instabil machen. Fortfahren?"
        "PowerPlan"         = "Energieplan auf Höchstleistung setzen"
        "DarkMode"          = "Dark Mode aktivieren"
        "TaskbarJunk"       = "Taskleiste säubern (Werbung, Such-Highlights, etc. entfernen)"
        "Telemetry"         = "Telemetrie & Datensammlung deaktivieren"
        "RemoveEdge"        = "Microsoft Edge entfernen"
        "SystemTweaks"      = "System-Tweaks anwenden (Lieferoptimierung, Treiber-Updates, Tipps/Püf Noktaları, Sperrbildschirm-Werbung, Fehlerberichterstattung, Game Bar)"
        "PerformanceTweaks" = "Performance-Tweaks anwenden (visuelle Effekte, Superfetch/SysMain)"
        "XboxApps"          = "Xbox Apps entfernen (Xbox App, Gaming Overlay, SpeechToTextOverlay)"
        "OneDrive"          = "OneDrive entfernen"
        "MixedReality"      = "Mixed Reality Portal entfernen"
        "CommonApps"        = "Häufige Bloatware-Apps entfernen (Solitaire, Skype, YourPhone, Wetter, Hilfe, Erste Schritte, Groove Musik, Filme & TV)"
        "AggressiveApps"    = "Aggressive Bloatware-Apps entfernen (Outlook, Mail, Kalender, Karten, Kontakte, Kamera, Rechner, 3D-Druck)"
        "AllAppsExceptBasics" = "ALLE Apps außer Paint & Fotos entfernen"
        "WindowsDefender"   = "Windows Defender und Sicherheitsfunktionen deaktivieren (KRITISCHES SICHERHEITSRISIKO)"
        "SmartScreen"       = "SmartScreen deaktivieren"
        "MicrosoftStore"    = "Microsoft Store entfernen"
        "SystemRestore"     = "Systemwiederherstellung deaktivieren"
        "Hibernation"       = "Ruhezustand deaktivieren"
        "TempFiles"         = "Temporäre Dateien löschen"
        "RemovePaint"       = "Microsoft Paint entfernen"
        "RemovePhotos"      = "Microsoft Fotos entfernen"
    }
    "tr" = @{
        "Welcome"           = "Debloatranium 2025'e hoş geldiniz!"
        "ChooseLang"        = "Dil seçin (en/de/tr):"
        "ChooseLevel"       = "Temizleme seviyesini seçin:"
        "Options"           = @(
            "1) Minimum - Hafif ayarlar, Yüksek Performans güç planı, Koyu Mod, Edge'i kaldır, görev çubuğunu temizle, telemetriyi devre dışı bırak",
            "2) Hafif - Ultra gereksiz uygulamaları kaldır (Xbox, OneDrive, Solitaire, YourPhone, Hava Durumu, Zune) + Minimum'daki her şey",
            "3) Orta - Daha fazla uygulama kaldır (Outlook, Posta, Takvim, Haritalar, Kişiler, Kamera, Hesap Makinesi, 3B Yazdırma) + birçok sistem ve performans ayarı + Hafif'teki her şey",
            "4) Yüksek - Paint ve Fotoğraflar dışındaki TÜM uygulamaları kaldır + çok sayıda ayar + Orta'daki her şey",
            "5) Aşırı - Maksimum performans için mümkün olan HER ŞEYİ kaldır (Mağaza, güvenlik özellikleri dahil) + Yüksek'teki her şey",
            "6) Özel - Neleri kaldıracağınızı/optimize edeceğinizi tek tek seçin"
        )
        "InvalidChoice"     = "Geçersiz seçim. Çıkılıyor."
        "Confirm"           = "Devam etmek istediğinizden emin misiniz? (E/H):"
        "Aborted"           = "Kullanıcı tarafından iptal edildi."
        "Running"           = "Temizleme seviyesi çalıştırılıyor:"
        "DownloadingBrowsers"= "Tarayıcılar indiriliyor ve kuruluyor..."
        "Done"              = "Debloatranium başarıyla tamamlandı."
        "Error"             = "Bir hata oluştu:"
        "NeedAdmin"         = "Lütfen bu betiği Yönetici olarak çalıştırın!"
        "YesNoPrompt"       = "Uygulamak ister misiniz? (E/H):"
        "IsFreshWindows"    = "Bu yeni bir Windows kurulumu mu? (E/H):"
        "EdgeWarning"       = "UYARI: Microsoft Edge kaldırılacaktır. Başka bir tarayıcınız olduğundan emin olun veya şimdi bir tane yükleyin."
        "AlreadyHaveBrowser"= "Zaten başka bir tarayıcı yüklü ve onu kullanmayı tercih ediyor musunuz? (E/H):"
        "RecommendedInstallBrowser" = "Debloat işleminden sonra internet erişiminiz olduğundan emin olmak için şimdi bir tarayıcı yüklemeniz şiddetle tavsiye edilir."
        "InstallAnyBrowsers"= "Herhangi bir tarayıcı yüklemek ister misiniz?"
        "NoBrowsersInstalled" = "Hiçbir tarayıcı yüklenmeyecek."
        "RestartPrompt"     = "PC'nizi yeniden başlatmak için bir tuşa basın..."
        "ExtremeWarning"    = "UYARI: Aşırı temizleme, Microsoft Mağazası gibi kritik bileşenleri kaldıracak ve güvenlik özelliklerini (Windows Defender, SmartScreen) devre dışı bırakacaktır. Bu, çoğu kullanıcı için ÖNERİLMEZ ve sisteminizi savunmasız ve kararsız hale getirebilir. Devam etmek istiyor musunuz?"
        "PowerPlan"         = "Güç Planını Yüksek Performansa Ayarla"
        "DarkMode"          = "Koyu Modu Etkinleştir"
        "TaskbarJunk"       = "Görev Çubuğunu Temizle (reklamları, arama vurgularını vb. kaldır)"
        "Telemetry"         = "Telemetri ve Veri Toplamayı Devre Dışı Bırak"
        "RemoveEdge"        = "Microsoft Edge'i Kaldır"
        "SystemTweaks"      = "Sistem Ayarlarını Uygula (Teslimat Optimizasyonu, Sürücü Güncellemeleri, İpuçları/Püf Noktaları, Kilit Ekranı Reklamları, Hata Raporlama, Oyun Çubuğu)"
        "PerformanceTweaks" = "Performans Ayarlarını Uygula (görsel efektler, Superfetch/SysMain)"
        "XboxApps"          = "Xbox Uygulamalarını Kaldır (Xbox Uygulaması, Oyun Yer Paylaşımı, Konuşmadan Metne Yer Paylaşımı)"
        "OneDrive"          = "OneDrive'ı Kaldır"
        "MixedReality"       = "Karma Gerçeklik Portalını Kaldır"
        "CommonApps"        = "Yaygın Gereksiz Uygulamaları Kaldır (Solitaire, Skype, YourPhone, Hava Durumu, Yardım Al, Başlangıç, Groove Müzik, Filmler ve TV)"
        "AggressiveApps"    = "Agresif Gereksiz Uygulamaları Kaldır (Outlook, Posta, Takvim, Haritalar, Kişiler, Kamera, Hesap Makinesi, 3B Yazdırma)"
        "AllAppsExceptBasics" = "Paint ve Fotoğraflar dışındaki TÜM uygulamaları kaldır"
        "WindowsDefender"   = "Windows Defender ve güvenlik özelliklerini devre dışı bırak (KRİTİK GÜVENLİK RİSKİ)"
        "SmartScreen"       = "SmartScreen'i Devre Dışı Bırak"
        "MicrosoftStore"    = "Microsoft Mağazasını Kaldır"
        "SystemRestore"     = "Sistem Geri Yüklemeyi Devre Dışı Bırak"
        "Hibernation"       = "Hazırda Bekletmeyi Devre Dışı Bırak"
        "TempFiles"         = "Geçici Dosyaları Temizle"
        "RemovePaint"       = "Microsoft Paint'i Kaldır"
        "RemovePhotos"      = "Microsoft Fotoğraflar'ı Kaldır"
    }
}

function Write-Log {
    param([string]$Message, [string]$Color="White")
    Write-Host $Message -ForegroundColor $Color
}

function Check-Admin {
    if (-not ([Security.Principal.WindowsPrincipal] `
        [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole(`
        [Security.Principal.WindowsBuiltinRole]::Administrator)) {
        Write-Log $txt.NeedAdmin Red
        exit 1
    }
}

function Confirm-Action {
    param(
        [string]$prompt,
        [string]$lang
    )
    Write-Host $prompt -ForegroundColor Yellow
    $answer = Read-Host
    if ($lang -eq "de") {
        return $answer.ToLower() -eq "j"
    } elseif ($lang -eq "tr") {
        return $answer.ToLower() -eq "e"
    } else {
        return $answer.ToLower() -eq "y"
    }
}

function Read-YesNo {
    param(
        [string]$prompt,
        [string]$lang
    )
    while ($true) {
        Write-Host "$prompt $($txt.YesNoPrompt)" -ForegroundColor Cyan
        $answer = Read-Host
        if ($lang -eq "de") {
            if ($answer.ToLower() -eq "j") { return $true }
            elseif ($answer.ToLower() -eq "n") { return $false }
        } elseif ($lang -eq "tr") {
            if ($answer.ToLower() -eq "e") { return $true }
            elseif ($answer.ToLower() -eq "h") { return $false }
        } else {
            if ($answer.ToLower() -eq "y") { return $true }
            elseif ($answer.ToLower() -eq "n") { return $false }
        }
        Write-Host "Please answer with Y/N (en), J/N (de), or E/H (tr)." -ForegroundColor Red
    }
}

function Remove-App {
    param([string]$packageName)
    try {
        Get-AppxPackage -Name $packageName -AllUsers | Remove-AppxPackage -ErrorAction SilentlyContinue
        Get-AppxProvisionedPackage -Online | Where-Object DisplayName -EQ $packageName | Remove-AppxProvisionedPackage -Online -ErrorAction SilentlyContinue
    }
    catch {
    }
}

function Disable-Service {
    param([string]$serviceName)
    try {
        Stop-Service -Name $serviceName -Force -ErrorAction SilentlyContinue
        Set-Service -Name $serviceName -StartupType Disabled
    }
    catch {
    }
}

function Set-PowerPlanHighPerformance {
    try {
        $highPerformanceGuid = (Get-WmiObject -Class Win32_PowerPlan | Where-Object {$_.ElementName -eq "High performance"}).InstanceID.Split("{")[1].Split("}")[0]
        powercfg /setactive $highPerformanceGuid
    }
    catch {
    }
}

function Enable-DarkMode {
    try {
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "AppsUseLightTheme" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "SystemUsesLightTheme" -Value 0 -Force -ErrorAction SilentlyContinue
    }
    catch {
    }
}

function Disable-TaskbarJunk {
    try {
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" -Name "EnableFeeds" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" -Name "SearchboxTaskbarMode" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ShowTaskbarButton" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "PeopleEnabled" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ShowCortanaButton" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ShowSyncProviderNotifications" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "TaskbarAl" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "TaskbarMn" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" -Name "EnableDynamicContentInSearch" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ShowTaskViewButton" -Value 0 -Force -ErrorAction SilentlyContinue
    }
    catch {
    }
}

function Debloat-Telemetry {
    Disable-Service -serviceName "DiagTrack"
    Disable-Service -serviceName "dmwappushservice"
    Disable-Service -serviceName "lfsvc"
}

function Remove-MicrosoftEdge {
    $edgePath = "$env:ProgramFiles(x86)\Microsoft\Edge\Application\msedge.exe"
    if (Test-Path $edgePath) {
        $uninstallPath = Get-ChildItem -Path "$env:ProgramFiles(x86)\Microsoft\Edge\Application" -Directory |
                         Sort-Object Name -Descending | Select-Object -First 1 |
                         ForEach-Object { Join-Path $_.FullName "Installer\setup.exe" }

        if (Test-Path $uninstallPath) {
            Start-Process -FilePath $uninstallPath -ArgumentList "--uninstall --force-uninstall --system-level" -Wait -NoNewWindow
        } else {
        }
    } else {
    }
}

function Apply-SystemTweaks {
    try {
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" -Name "DODownloadMode" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings" -Name "ExcludeWUDriversInQualityUpdate" -Value 1 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" -Name "SubscribedContent-338387Enabled" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" -Name "RotatingLockScreenOverlayEnabled" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting" -Name "Disabled" -Value 1 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\GameDVR" -Name "AllowGameDVR" -Value 0 -Force -ErrorAction SilentlyContinue
    }
    catch {
    }
}

function Apply-PerformanceTweaks {
    try {
        Disable-Service -serviceName "SysMain"
        Disable-Service -serviceName "WSearch"
        Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name "FontSmoothing" -Value 2 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name "UserPreferencesMask" -Value ([byte[]](0x90, 0x12, 0x01, 0x80, 0x10, 0x00, 0x00, 0x00)) -Force -ErrorAction SilentlyContinue
    }
    catch {
    }
}

function Remove-AllAppsExceptBasics {
    $excludedApps = @(
        "Microsoft.Paint",
        "Microsoft.Windows.Photos",
        "Microsoft.Windows.ShellExperienceHost",
        "Microsoft.Windows.Cortana",
        "Microsoft.Windows.CloudExperienceHost",
        "Microsoft.SecHealthUI",
        "Microsoft.DesktopAppInstaller",
        "Microsoft.UI.Xaml.2.x",
        "Microsoft.VCLibs.140.00",
        "Microsoft.NET.Native.Framework.x.x",
        "Microsoft.NET.Native.Runtime.x.x",
        "Microsoft.Web.WebView2Runtime",
        "Microsoft.Windows.OOBE"
    )
    Get-AppxPackage -AllUsers | Where-Object { $_.Name -notin $excludedApps } | ForEach-Object {
        Remove-AppxPackage -Package $_.PackageFullName -ErrorAction SilentlyContinue
        Get-AppxProvisionedPackage -Online | Where-Object DisplayName -EQ $_.Name | Remove-AppxProvisionedPackage -Online -ErrorAction SilentlyContinue
    }
}

function Debloat-ExtremeAggressiveActions {
    Remove-App "Microsoft.WindowsStore"
    Remove-App "Microsoft.StorePurchaseApp"

    try {
        Set-MpPreference -DisableRealtimeMonitoring $true -ErrorAction SilentlyContinue
        Set-MpPreference -DisableBehaviorMonitoring $true -ErrorAction SilentlyContinue
        Set-MpPreference -DisableOnAccessProtection $true -ErrorAction SilentlyContinue
        Set-MpPreference -DisableIOAVProtection $true -ErrorAction SilentlyContinue
        Set-MpPreference -MAPSReporting 0 -ErrorAction SilentlyContinue
        Set-MpPreference -SubmitSamplesConsent 2 -ErrorAction SilentlyContinue
    }
    catch {
    }

    try {
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\SmartScreenEnabled" -Name "ShellSmartScreenEnabled" -Value "Off" -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name "EnableSmartScreen" -Value 0 -Force -ErrorAction SilentlyContinue
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost" -Name "EnableWebContentEvaluation" -Value 0 -Force -ErrorAction SilentlyContinue
    }
    catch {
    }

    try {
        Disable-ComputerRestore -Drive C: -ErrorAction SilentlyContinue
    }
    catch {
    }

    try {
        powercfg /h off
    }
    catch {
    }

    try {
        Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
        Remove-Item "$env:SystemRoot\temp\*" -Recurse -Force -ErrorAction SilentlyContinue
    }
    catch {
    }
}

function Download-And-Install-Browser {
    param(
        [string]$name,
        [string]$url,
        [string]$installerArgs = "/silent /install"
    )
    $tempInstaller = "$env:TEMP\$name-installer.exe"
    try {
        [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12 -bor [Net.SecurityProtocolType]::Tls11 -bor [Net.SecurityProtocolType]::Tls
        Invoke-WebRequest -Uri $url -OutFile $tempInstaller -UseBasicParsing -ErrorAction Stop

        if (Test-Path $tempInstaller) {
            Start-Process -FilePath $tempInstaller -ArgumentList $installerArgs -Wait -ErrorAction Stop
        } else {
        }
    }
    catch {
    }
    finally {
        if (Test-Path $tempInstaller) {
            Remove-Item $tempInstaller -Force -ErrorAction SilentlyContinue
        }
    }
}

function Choose-And-Install-Browsers {
    param(
        [string]$lang,
        [bool]$forcePrompt = $false
    )
    if ($forcePrompt -or (Read-YesNo $txt.InstallAnyBrowsers $lang)) {
        if (Read-YesNo "Install Google Chrome?" $lang) {
            Download-And-Install-Browser -name "Google Chrome" -url "https://dl.google.com/chrome/install/latest/chrome_installer.exe" -installerArgs "/silent /install"
        }
        if (Read-YesNo "Install Mozilla Firefox?" $lang) {
            Download-And-Install-Browser -name "Mozilla Firefox" -url "https://download.mozilla.org/?product=firefox-stub&os=win&lang=en-US" -installerArgs "-ms"
        }
        if (Read-YesNo "Install Opera GX?" $lang) {
            Download-And-Install-Browser -name "Opera GX" -url "https://download.opera.com/download/get/?partner=www&os=windows&type=gx" -installerArgs "/silent"
        }
        if (Read-YesNo "Install Opera?" $lang) {
            Download-And-Install-Browser -name "Opera" -url "https://download.opera.com/download/get/?partner=www&os=windows" -installerArgs "/silent"
        }
    } else {
    }
}

function Debloat-Minimum {
    Set-PowerPlanHighPerformance
    Enable-DarkMode
    Remove-MicrosoftEdge
    Disable-TaskbarJunk
    Debloat-Telemetry
    Apply-SystemTweaks
    Apply-PerformanceTweaks
}

function Debloat-Light {
    Debloat-Minimum
    
    Remove-App "Microsoft.XboxApp"
    Remove-App "Microsoft.XboxGamingOverlay"
    Remove-App "Microsoft.XboxSpeechToTextOverlay"
    Remove-App "Microsoft.OneDrive"
    Remove-App "Microsoft.MixedReality.Portal"
    Remove-App "Microsoft.MicrosoftSolitaireCollection"
    Remove-App "Microsoft.SkypeApp"
    Remove-App "Microsoft.YourPhone"
    Remove-App "Microsoft.BingWeather"
    Remove-App "Microsoft.GetHelp"
    Remove-App "Microsoft.Getstarted"
    Remove-App "Microsoft.ZuneMusic"
    Remove-App "Microsoft.ZuneVideo"
}

function Debloat-Medium {
    Debloat-Light

    Remove-App "Microsoft.OutlookForWindows"
    Remove-App "Microsoft.Windows.Mail"
    Remove-App "Microsoft.Windows.Calendar"
    Remove-App "Microsoft.WindowsMaps"
    Remove-App "Microsoft.People"
    Remove-App "Microsoft.WindowsCamera"
    Remove-App "Microsoft.WindowsCalculator"
    Remove-App "Microsoft.Print3D"
}

function Debloat-High {
    Debloat-Medium
    Remove-AllAppsExceptBasics
}

function Debloat-Extreme {
    if (-not (Confirm-Action $txt.ExtremeWarning $chosenLang)) {
        Write-Host $txt.Aborted -ForegroundColor Red
        exit
    }

    Debloat-High

    Debloat-ExtremeAggressiveActions

    Remove-App "Microsoft.Paint"
    Remove-App "Microsoft.Windows.Photos"
}

function Debloat-Custom {
    if (Read-YesNo $txt.PowerPlan $chosenLang) { Set-PowerPlanHighPerformance }
    if (Read-YesNo $txt.DarkMode $chosenLang) { Enable-DarkMode }
    if (Read-YesNo $txt.RemoveEdge $chosenLang) { Remove-MicrosoftEdge }
    if (Read-YesNo $txt.TaskbarJunk $chosenLang) { Disable-TaskbarJunk }
    if (Read-YesNo $txt.Telemetry $chosenLang) { Debloat-Telemetry }
    if (Read-YesNo $txt.SystemTweaks $chosenLang) { Apply-SystemTweaks }
    if (Read-YesNo $txt.PerformanceTweaks $chosenLang) { Apply-PerformanceTweaks }
    
    if (Read-YesNo $txt.XboxApps $chosenLang) { Remove-App "Microsoft.XboxApp"; Remove-App "Microsoft.XboxGamingOverlay"; Remove-App "Microsoft.XboxSpeechToTextOverlay" }
    if (Read-YesNo $txt.OneDrive $chosenLang) { Remove-App "Microsoft.OneDrive" }
    if (Read-YesNo $txt.MixedReality $chosenLang) { Remove-App "Microsoft.MixedReality.Portal" }
    if (Read-YesNo $txt.CommonApps $chosenLang) {
        Remove-App "Microsoft.MicrosoftSolitaireCollection"
        Remove-App "Microsoft.SkypeApp"
        Remove-App "Microsoft.YourPhone"
        Remove-App "Microsoft.BingWeather"
        Remove-App "Microsoft.GetHelp"
        Remove-App "Microsoft.Getstarted"
        Remove-App "Microsoft.ZuneMusic"
        Remove-App "Microsoft.ZuneVideo"
    }
    if (Read-YesNo $txt.AggressiveApps $chosenLang) {
        Remove-App "Microsoft.OutlookForWindows"
        Remove-App "Microsoft.Windows.Mail"
        Remove-App "Microsoft.Windows.Calendar"
        Remove-App "Microsoft.WindowsMaps"
        Remove-App "Microsoft.People"
        Remove-App "Microsoft.WindowsCamera"
        Remove-App "Microsoft.WindowsCalculator"
        Remove-App "Microsoft.Print3D"
    }
    if (Read-YesNo $txt.AllAppsExceptBasics $chosenLang) { Remove-AllAppsExceptBasics }
    
    if (Read-YesNo $txt.WindowsDefender $chosenLang) {
        try {
            Set-MpPreference -DisableRealtimeMonitoring $true -ErrorAction SilentlyContinue
            Set-MpPreference -DisableBehaviorMonitoring $true -ErrorAction SilentlyContinue
            Set-MpPreference -DisableOnAccessProtection $true -ErrorAction SilentlyContinue
            Set-MpPreference -DisableIOAVProtection $true -ErrorAction SilentlyContinue
            Set-MpPreference -MAPSReporting 0 -ErrorAction SilentlyContinue
            Set-MpPreference -SubmitSamplesConsent 2 -ErrorAction SilentlyContinue
        }
        catch {
        }
    }
    if (Read-YesNo $txt.SmartScreen $chosenLang) {
        try {
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\SmartScreenEnabled" -Name "ShellSmartScreenEnabled" -Value "Off" -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name "EnableSmartScreen" -Value 0 -Force -ErrorAction SilentlyContinue
            Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost" -Name "EnableWebContentEvaluation" -Value 0 -Force -ErrorAction SilentlyContinue
        }
        catch {
        }
    }
    if (Read-YesNo $txt.MicrosoftStore $chosenLang) { Remove-App "Microsoft.WindowsStore"; Remove-App "Microsoft.StorePurchaseApp" }
    if (Read-YesNo $txt.SystemRestore $chosenLang) {
        try { Disable-ComputerRestore -Drive C: -ErrorAction SilentlyContinue }
        catch { }
    }
    if (Read-YesNo $txt.Hibernation $chosenLang) {
        try { powercfg /h off }
        catch { }
    }
    if (Read-YesNo $txt.TempFiles $chosenLang) {
        try { Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item "$env:SystemRoot\temp\*" -Recurse -Force -ErrorAction SilentlyContinue }
        catch { }
    }

    if (Read-YesNo $txt.RemovePaint $chosenLang) { Remove-App "Microsoft.Paint" }
    if (Read-YesNo $txt.RemovePhotos $chosenLang) { Remove-App "Microsoft.Windows.Photos" }
}

try {
    Clear-Host
    Check-Admin

    Write-Host $Lang.en.ChooseLang -ForegroundColor Cyan
    $chosenLang = Read-Host
    if ($chosenLang -ne "de" -and $chosenLang -ne "en" -and $chosenLang -ne "tr") { $chosenLang = "en" }
    $txt = $Lang[$chosenLang]

    Write-Host "`n$($txt.Welcome)" -ForegroundColor Cyan

    $browsersAlreadyHandled = $false

    if (Read-YesNo $txt.IsFreshWindows $chosenLang) {
        Write-Host $txt.EdgeWarning -ForegroundColor Green
        if (-not (Read-YesNo $txt.AlreadyHaveBrowser $chosenLang)) {
            Write-Host $txt.RecommendedInstallBrowser -ForegroundColor Yellow
            Choose-And-Install-Browsers -lang $chosenLang -forcePrompt $true
            $browsersAlreadyHandled = $true
        }
    }

    Write-Host $txt.ChooseLevel -ForegroundColor Yellow
    foreach ($option in $txt.Options) {
        Write-Host $option -ForegroundColor Green
    }

    $choice = Read-Host "Enter number / Nummer eingeben"
    if ($choice -notin "1","2","3","4","5","6") {
        Write-Host $txt.InvalidChoice -ForegroundColor Red
        exit
    }

    if (-not (Confirm-Action $txt.Confirm $chosenLang)) {
        Write-Host $txt.Aborted -ForegroundColor Red
        exit
    }

    Write-Host "$($txt.Running) $choice" -ForegroundColor Yellow

    switch ($choice) {
        "1" { Debloat-Minimum }
        "2" { Debloat-Light }
        "3" { Debloat-Medium }
        "4" { Debloat-High }
        "5" { Debloat-Extreme }
        "6" { Debloat-Custom }
    }

    if (-not $browsersAlreadyHandled) {
        Choose-And-Install-Browsers -lang $chosenLang -forcePrompt $false
    }

    Write-Host "`n$($txt.Done)" -ForegroundColor Cyan

    Write-Host $txt.RestartPrompt -ForegroundColor Yellow
    Write-Host "Press any key to restart or Ctrl+C to cancel..." -ForegroundColor Cyan
    [void][System.Console]::ReadKey($true)
    Restart-Computer -Force
}
catch {
    Write-Host "$($txt.Error) $_" -ForegroundColor Red
    exit 1
}
